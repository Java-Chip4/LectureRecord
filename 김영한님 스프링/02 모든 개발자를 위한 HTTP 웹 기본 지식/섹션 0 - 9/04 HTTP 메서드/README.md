# 모든 개발자를 위한 HTTP 웹 기본 지식
## 4. HTTP 메서드
### 4.1 HTTP API를 만들어보자
**_회원 정보를 관리하는 API를 구성해보려고 한다_**  

- API URI 설계
  - 회원 목록 조회 /read-member-list
  - 회원 조회 /read-member-by-id
  - 회원 등록 /create-member
  - 회원 수정 /update-member
  - 회원 삭제 /delete-member

**_아래와 같은 URI 구성은 올바른 설계일까?_** **_아니다._**  
**_가장 중요한 것은 `리소스 식별`이다_**

- 리소스란?
  - 회원을 등록하고 수정하고, 조회하는 게 리소스가 아니다
  - 회원이라는 개념 자체가 리소스다

**_리소스 식별이 이뤄진 API URI를 갖도록 리팩토링을 해보자_**

- API URI 설계 리팩토링
  - 회원 목록 조회 /members
  - 회원 조회 /members/{id}
  - 회원 등록 /members/{id}
  - 회원 수정 /members/{id}
  - 회원 삭제 /members/{id}

_**여전히 나타나는 문제점이 있다.**_ _**같은 URI를 어떻게 서로 구분할 수 있을까?**_  
**_`리소스`와 `행위`를 구분함으로써 가능하다_**

- 리소스와 행위를 분리하자
  - 가장 중요한 것은 리소스를 식별하는 것
  - URI는 리소스만 식별해야 한다
  - 리소스와 해당 리소스를 대상으로 하는 행위를 분리

### 4.2 HTTP 메서드 - GET, POST
- GET : 리소스 조회
- POST : 요청 데이터 처리, 주로 등록

- 추가
  - HEAD : GET과 동일하지만 바디를 제외하고, 상태 줄과 헤더만 반환
  - OPTIONS
  - CONNECT
  - TRACE

- GET
  - 리소스 조회
  - 서버에 전달하고 싶은 데이터는 query를 통해서 전달
  - 메시지 바디를 사용해서 데이터를 전달할 수 있지만, 지원하는 곳이 많아서 권장 X

- POST
  - 요청 데이터 처리
  - 메시지 바디를 통해 서버로 요청 데이터 전달
  - 서버는 요청 데이터를 처리
    - 대상 리소스가 리소스의 고유한 의미 체계에 따라 요청에 포함된 표현을 처리하도록 요청한다
    - POST의 결과로 새로운 리소스가 생성되지 않을 수도 있음
      - ex) POST /order/{orderId}/start-delivery (컨트롤 URI)

### 4.3 HTTP 메서드 - PUT, PATCH, DELETE
- PUT
  - 리소스를 대체 = **덮어쓰기**
    - 기존에 존재하던 필드를 넣어주지 않으면, 넣어주지 않은 기존 필드 값은 삭제되어 버림
  - **클라이언트가 리소스를 식별한다** -> POST와 차이점

- PATCH
  - 간혹 지원되지 않는 서버도 있다
    - POST 사용으로 대체

### 4.4 HTTP 메서드의 속성
- 안전 Safe
  - 사례 : GET, HEAD, CONNECT, OPTION 
  - 호출해도 리소스를 변경하지 않는다
    - 해당 리소스만 고려하기 때문에, 서버 이슈는 상관 X

- 멱등 Idempotent
  - f(f(x)) = f(x)
    - 한 번 호출하던 두 번 호출하던, 100번 호출하던 결과가 똑같다
  - 사례
    - GET : 계속 조회해도 멱등하다
    - PUT : 계속 덮어쓰기 해도 멱등하다
    - POST : 중복 결제가 될 수 있기에 **멱등하지 않다**
    - 참고 : <img width="708" alt="스크린샷 2022-09-22 오후 5 36 33" src="https://user-images.githubusercontent.com/13804810/191699509-30fca91a-a674-4cd2-9401-a834493ccd63.png">
  - 활용
    - 자동 복구 매커니즘
      - 서버로부터 response를 못받았을때, 다시 request를 보내도 되는가?
      - 멱등하다면 OK.

- 캐시 가능 Cacheable
  - 응답 결과 리소스를 캐시해서 사용해도 되는가?
    - GET, HEAD, POST, PATCH 캐시 가능
      - 실제로는 GET, HEAD 정도만 캐시로 사용
        - 나머지는 본문 내용까지 캐시 키로 고려해야 하는데, 구현이 쉽지 않아서 잘 사용하지 않음

---

참고 : [김영한님 - 모든 개발자를 위한 HTTP 웹 기본 지식](https://www.inflearn.com/course/http-%EC%9B%B9-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC/)
